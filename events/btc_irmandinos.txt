namespace = btc_irmandinos
normal_or_historical_nations = yes

# Irmandinos Revolt #

country_event = {
	id = btc_irmandinos.1
	title = btc_irmandinos.1_t
	desc = btc_irmandinos.1_d
	picture = ANGRY_MOB_eventPicture

	fire_only_once = yes

	major = yes

	trigger = {
		tag = CAS
		any_owned_province = {
			has_province_modifier = strong_nobility
		}
	}

	mean_time_to_happen = {
		months = 240
	}

	option = {	# Help the local nobility fight the peasantry
		name = btc_irmandinos.1a

		ai_chance = {
			factor = 0.1
		}

		every_owned_province = {
			limit = {
				area = galicia_area
			}
			add_province_modifier = {
			name = galician_revolts	# +5 global unrest
			duration = 1825
			}
		}

		206 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}
		4555 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}
		4554 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}
		4558 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}

		every_owned_province = {
			limit = {
				area = galicia_area
			}
			add_devastation = 50
		}
	}

	option = {	# Let the nobles fight the peasants
		name = btc_irmandinos.1b

		ai_chance = {
			factor = 0.9
		}

		every_owned_province = {
			limit = { has_province_modifier = strong_nobility }
			remove_province_modifier = strong_nobility
		}

		206 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
				win = yes
			}
		}
		4555 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
				win = yes
			}
		}
		4554 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
				win = yes
			}
		}
		4558 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
				win = yes
			}
		}

		hidden_effect = {
			CAS = { set_country_flag = abandon_galicia }
			POR = {
				country_event = {
					id = btc_irmandinos.4
					days = 15
				}
			}			
		}
	}
}

# Pontevedra Destroyed #

country_event = {
	id = btc_irmandinos.2
	title = btc_irmandinos.2_t
	desc = btc_irmandinos.2_d
	picture = SIEGE_eventPicture

	fire_only_once = yes

	trigger = {
		tag = CAS
		4555 = {
			owned_by = CAS
			has_building = fort_15th
			controlled_by = leadered_peasant_rebels
		}
		OR = {
			CAS = { has_country_flag = abandon_galicia }
			any_owned_province = {
				has_province_modifier = strong_nobility
			}
		}
	}

	option = {
		name = btc_irmandinos.2a

		4555 = { remove_building = fort_15th }
	}
}

# Lugo Destroyed #

country_event = {
	id = btc_irmandinos.3
	title = btc_irmandinos.3_t
	desc = btc_irmandinos.3_d
	picture = SIEGE_eventPicture

	fire_only_once = yes

	trigger = {
		tag = CAS
		4554 = {
			owned_by = CAS
			has_building = fort_15th
			controlled_by = leadered_peasant_rebels
		}
		OR = {
			CAS = { has_country_flag = abandon_galicia }
			any_owned_province = {
				has_province_modifier = strong_nobility
			}
		}
	}

	option = {
		name = btc_irmandinos.3a

		4554 = { remove_building = fort_15th }
	}
}

# Galicia calls for aid #

country_event = {
	id = btc_irmandinos.4
	title = btc_irmandinos.4_t
	desc = btc_irmandinos.4_d
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	option = {	# And Portugal will answer
		name = btc_irmandinos.4a

		ai_chance = {
			factor = 0.9
		}

		add_manpower = -5
		add_army_tradition = 5
		set_country_flag = helped_galicia
	}

	option = {	# Let us not get involved
		name = btc_irmandinos.4b

		ai_chance = {
			factor = 0.1
		}

		add_prestige = -10
	}
}