namespace = btc_gra
normal_or_historical_nations = yes

# Pay the Paria
country_event = {
	id = btc_gra.1
	title = btc_gra.1_t
	desc = btc_gra.1_d
	picture = DEBATE_REPUBLICAN_eventPicture

	trigger = {
		tag = GRA
		NOT = { truce_with = CAS }
		NOT = { has_country_flag = paria_not_paid }
		NOT = { is_year = 1475 }
	}

	option = {
		name = btc_gra.1a

		ai_chance = {
			factor = 80
		}

		add_years_of_income = -0.5
		add_truce_with = CAS
		CAS = { 
			country_event = { 
				id = btc_gra.2 
				days = 1
			}
		}
	}

	option = {
		name = btc_gra.1b

		ai_chance = {
			factor = 20
		}

		set_country_flag = paria_not_paid
		CAS = { 
			country_event = { 
				id = btc_gra.3 
				days = 1
			}
		}
	}
}

# Paria Paid
country_event = {
	id = btc_gra.2
	title = btc_gra.2_t
	desc = btc_gra.2_d
	picture = CORRUPTION_eventPicture

	is_triggered_only = yes

	option = {
		name = btc_gra.2a

		add_years_of_income = 0.05
		add_opinion = {
			who = GRA
			modifier = paria_paid	# +100
		}
		if = {
			limit = {
				NOT = { has_guaranteed = GRA }
			}
			create_guarantee = GRA
		}
	}
}

# Paria Not Paid
country_event = {
	id = btc_gra.3
	title = btc_gra.3_t
	desc = btc_gra.3_d
	picture = BANKRUPCY_eventPicture

	is_triggered_only = yes

	option = {
		name = btc_gra.3a

		ai_chance = {
			factor = 1
		}

		upper_andalucia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		if = {
			limit = {
				has_guaranteed = GRA
			}
			remove_guarantee = GRA
		}
		add_country_modifier = {
			name = finish_reconquista
			duration = 1825
		}
		hidden_effect = {
			if = {
				limit = { 
					ai = yes
				}
				declare_war_with_cb = {
					casus_belli = cb_conquest
					who = GRA
				}
			}			
		}
	}

	option = {
		name = btc_gra.3b

		ai_chance = {
			factor = 0
		}

		if = {
			limit = {
				has_guaranteed = GRA
			}
			remove_guarantee = GRA
		}
		add_truce_with = GRA
	}
}