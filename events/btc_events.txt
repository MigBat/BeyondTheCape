namespace = btc_events
normal_or_historical_nations = yes

# Quest for the New World #

country_event = {
	id = btc_events.1
	title = btc_events.1_t
	desc = btc_events.1_d
	picture = EXPLORERS_eventPicture

	trigger = {
		NOT = { has_country_flag = quest_for_the_new_world }
		NOT = { has_country_modifier = quest_for_the_new_world }
		has_idea_group = exploration_ideas
		dip_tech = 7
	}

	option = {
		name = btc_events.1a

		add_country_modifier = {
			name = quest_for_the_new_world	# may hire explorers, conquistadors and discover ocean tiles
			duration = -1
		}
		set_country_flag = quest_for_the_new_world
	}
}

# Morocco defend against Iberians #

country_event = {
	id = btc_events.2
	title = btc_events.2_t
	desc = btc_events.2_d
	picture = RELIGIOUS_WARS_eventPicture

	fire_only_once = yes

	trigger = {
		tag = MOR
	}

	option = {
		name = btc_events.2a

		marrekesh_area = {
			add_province_modifier = {
				name = resist_reconquista
				duration = 36500
			}
		}
		fez_area = {
			add_province_modifier = {
				name = resist_reconquista
				duration = 36500
			}
		}
	}
}

# Granada defend against Castile #

# country_event = {
# 	id = btc_events.3
# 	title = btc_events.3_t
# 	desc = btc_events.3_d
# 	picture = RELIGIOUS_WARS_eventPicture

# 	fire_only_once = yes

# 	trigger = {
# 		tag = GRA
# 	}

# 	option = {
# 		name = btc_events.3a

# 		upper_andalucia_area = {
# 			add_province_modifier = {
# 				name = resist_reconquista
# 				duration = 10950
# 			}
# 		}
# 	}
# }

# Galician Nobles rule the region #

country_event = {
	id = btc_events.4
	title = btc_events.4_t
	desc = btc_events.4_d
	picture = CORRUPTION_eventPicture

	fire_only_once = yes

	trigger = {
		tag = CAS
	}

	option = {
		name = btc_events.4a

		galicia_area = {
			add_province_modifier = {
				name = strong_nobility
				duration = -1
			}
		}
	}
}

# Monthly OPM Diplo Calculation #

country_event = {
	id = btc_events.5
	title = btc_events.5_t
	desc = btc_events.5_d

	is_triggered_only = yes
	hidden = yes

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = btc_events.5a

		trigger = {
			AND = {
				num_of_cities = 1
				NOT = { num_of_cities = 2 }
			}
		}

		if = {
			limit = {
				NOT = {
					has_country_modifier = opm_diplomacy
				}
			}
			add_country_modifier = {
				name = opm_diplomacy
				duration = -1
			}
		}
	}

	option = {
		name = btc_events.5b

		trigger = {
			num_of_cities = 2
		}

		if = {
			limit = {
				has_country_modifier = opm_diplomacy
			}
			remove_country_modifier = opm_diplomacy
		}
	}
}

# Remove dev with high devastation

province_event = {
	id = btc_events.6
	title = btc_events.6_t
	desc = btc_events.6_d

	hidden = yes
	
	trigger = {
		devastation = 10
		OR = {
			NOT = { has_province_flag = dev_reduced_recently }
			had_province_flag = { flag = dev_reduced_recently days = 730 }
		}
		development = 4
	}

	mean_time_to_happen = {
		months = 24
		modifier = {
			factor = 0.5
			devastation = 20
		}
		modifier = {
			factor = 0.5
			devastation = 30
		}
		modifier = {
			factor = 0.5
			devastation = 40
		}
		modifier = {
			factor = 0.5
			devastation = 50
		}
	}

	option = {
		name = btc_events.6a

		random_list = {
			33 = { add_base_tax = -1 }
			33 = { add_base_production = -1 }
			33 = { add_base_manpower = -1 }
		}
		set_province_flag = dev_reduced_recently
	}
}