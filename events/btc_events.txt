namespace = btc_events
normal_or_historical_nations = yes

# Quest for the New World #

country_event = {
	id = btc_events.1
	title = btc_events.1_t
	desc = btc_events.1_t
	picture = EXPLORERS_eventPicture

	trigger = {
		NOT = { has_country_flag = quest_for_the_new_world }
		has_idea_group = exploration_ideas
		dip_tech = 7
	}

	option = {
		name = btc_events.1a

		add_country_modifier = {
			name = quest_for_the_new_world	# may hire explorers, conquistadors and discover ocean tiles
			duration = -1
		}
		set_country_flag = quest_for_the_new_world
	}
}

# Granada defend against Castile #

country_event = {
	id = btc_events.2
	title = btc_events.2_t
	desc = btc_events.2_d
	picture = RELIGIOUS_WARS_eventPicture

	fire_only_once = yes

	trigger = {
		tag = GRA
	}

	option = {
		name = btc_events.2a

		upper_andalucia_area = {
			add_province_modifier = {
				name = resist_reconquista
				duration = 10950
			}
		}
	}
}

# Irmandinos Revolt #

country_event = {
	id = btc_events.3
	title = btc_events.3_t
	desc = btc_events.3_d
	picture = ANGRY_MOB_eventPicture

	fire_only_once = yes

	major = yes

	trigger = {
		tag = CAS
		any_owned_province = {
			has_province_modifier = strong_nobility
		}
	}

	mean_time_to_happen = {
		months = 60
	}

	option = {	# Help the local nobility fight the peasantry
		name = btc_events.3a

		ai_chance = {
			factor = 0.1
		}

		add_years_of_income = -0.5
		add_manpower = -10
		every_owned_province = {
			limit = {
				area = galicia_area
			}
			add_province_modifier = {
			name = galician_revolts	# +5 global unrest
			duration = 1825
		}
		}		
		
		every_owned_province = {
			limit = {
				area = galicia_area
			}
			add_devastation = 50
		}
	}

	option = {	# Let the nobles fight the peasants
		name = btc_events.3b

		ai_chance = {
			factor = 0.9
		}

		every_owned_province = {
			limit = { has_province_modifier = strong_nobility }
			remove_province_modifier = strong_nobility
		}
		hidden_effect = {
			create_vassal = GAL
		}
		custom_tooltip = galicia_vassal
		GAL = {
			add_opinion = {
				who = CAS
				modifier = ignored_our_affairs	# -200 opinion
			}
			add_manpower = 10
			country_event = {
				id = btc_events.4
				days = 30
			}
		}
	}
}

# Galician peasant uprising #

country_event = {
	id = btc_events.4
	title = btc_events.4_t
	desc = btc_events.4_d
	picture = SIEGE_eventPicture

	is_triggered_only = yes

	option = {	# We will suppress them by ourselves
		name = btc_events.4a

		ai_chance = {
			factor = 0.1
		}

		206 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				friend = CAS
				size = 3
				win = yes
			}
		}
	}

	option = {	# Castile has abandoned us, let us turn to Portugal
		name = btc_events.4b

		ai_chance = {
			factor = 0.9
		}

		206 = {
			spawn_rebels = {
				type = leadered_peasant_rebels
				friend = CAS
				size = 3
				win = yes
			}
		}

		POR = {
			country_event = {
				id = btc_events.5
				days = 15
			}
		}
	}
}

# Galicia calls for aid #

country_event = {
	id = btc_events.5
	title = btc_events.5_t
	desc = btc_events.5_d
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	option = {	# And Portugal will answer
		name = btc_events.5a

		ai_chance = {
			factor = 0.9
		}

		add_manpower = -4
		GAL = {
			country_event = {
				id = btc_events.6
				days = 15
			}
		}
	}

	option = {	# Let us not get involved
		name = btc_events.5b

		ai_chance = {
			factor = 0.1
		}

		GAL = {
			country_event = {
				id = btc_events.7
				days = 15
			}
		}
	}
}

# Help from Portugal #

country_event = {
	id = btc_events.6
	title = btc_events.6_t
	desc = btc_events.6_d
	picture = HORDE_ON_HORSEBACK_eventPicture

	is_triggered_only = yes

	option = {	# Help has arrived!
		name = btc_events.6a

		set_country_flag = portugal_helped

		add_liberty_desire = 50

		add_opinion = {
			who = POR
			modifier = came_to_our_aid	# 100 opinion
		}

		define_general = {
			name = "Pedro Madruga"
			shock = 3
			fire = 3
			manuever = 2
			siege = 0
		}

		4558 = {
			cavalry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
		}
	}
}

# We stand alone #

country_event = {
	id = btc_events.7
	title = btc_events.7_t
	desc = btc_events.7_d
	picture = BANKRUPTCY_eventPicture

	is_triggered_only = yes

	option = {	# We have been forsaken
		name = btc_events.7a

		GAL = {
			add_opinion = {
				who = POR
				modifier = forsaken_us	# -100 opinion
			}
		}
	}
}

# Morocco defend against Iberians #

country_event = {
	id = btc_events.8
	title = btc_events.8_t
	desc = btc_events.8_d
	picture = RELIGIOUS_WARS_eventPicture

	fire_only_once = yes

	trigger = {
		tag = MOR
	}

	option = {
		name = btc_events.8a

		marrekesh_area = {
			add_province_modifier = {
				name = resist_reconquista
				duration = 36500
			}
		}
	}
}

# Galician Nobles rule the region #

country_event = {
	id = btc_events.9
	title = btc_events.9_t
	desc = btc_events.9_d
	picture = CORRUPTION_eventPicture

	fire_only_once = yes

	trigger = {
		tag = CAS
	}

	option = {
		name = btc_events.9a

		galicia_area = {
			add_province_modifier = {
				name = strong_nobility
				duration = -1
			}
		}
	}
}